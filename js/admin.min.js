!function(a){a("#menu-icons-settings-tabs").on("click","a.mi-settings-nav-tab",function(b){b.preventDefault(),b.stopPropagation();var c=a(this).blur(),d=a("#"+c.data("type"));c.parent().addClass("tabs").siblings().removeClass("tabs"),d.removeClass("tabs-panel-inactive").addClass("tabs-panel-active").show().siblings("div.tabs-panel").hide().addClass("tabs-panel-inactive").removeClass("tabs-panel-active")}).find("a.mi-settings-nav-tab").first().click(),a("#menu-icons-settings-save").on("click",function(b){var c=a(this).prop("disabled",!0),d=c.siblings("span.spinner");b.preventDefault(),b.stopPropagation(),d.css({display:"inline-block",visibility:"visible"}),a.ajax({type:"POST",url:menuIcons.ajaxUrls.update,data:a("#menu-icons-settings :input").serialize(),success:function(a){!0===a.success&&a.data.redirectUrl?window.location=a.data.redirectUrl:c.prop("disabled",!1)},always:function(){d.hide()}})})}(jQuery),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){wp.media.model.MenuIconsItem=a("./models/item.js"),wp.media.view.MediaFrame.MenuIcons=a("./views/frame.js")},{"./models/item.js":2,"./views/frame.js":3}],2:[function(a,b,c){var d=Backbone.Model.extend({initialize:function(){this.on("change",this.updateValues,this)},updateValues:function(){_.each(this.get("$inputs"),function(a,b){a.val(this.get(b))},this),this.get("$el").trigger("mi:update")}});b.exports=d},{}],3:[function(a,b,c){var d=wp.media.view.MediaFrame.IconPicker.extend({initialize:function(){this.menuItems=new Backbone.Collection([],{model:wp.media.model.MenuIconsItem}),wp.media.view.MediaFrame.IconPicker.prototype.initialize.apply(this,arguments),this.listenTo(this.target,"change",this.miUpdateItemProps)},miUpdateItemProps:function(){var a=this.target.id,b=this.menuItems.get(a),c=this.target.toJSON();b.set(c),this.target.clear({silent:!0})}});b.exports=d},{}]},{},[1]),function(a){if(menuIcons.activeTypes&&!_.isEmpty(menuIcons.activeTypes)){var b={templates:{},wrapClass:"div.menu-icons-wrap",frame:null,target:new wp.media.model.IconPickerTarget,typesFilter:function(b){return-1<a.inArray(b.id,menuIcons.activeTypes)},createFrame:function(){b.frame=new wp.media.view.MediaFrame.MenuIcons({target:b.target,ipTypes:_.filter(iconPicker.types,b.typesFilter)})},pickIcon:function(a){b.frame.target.set(a,{silent:!0}),b.frame.open()},setUnset:function(c){var d=a(c.currentTarget),e=a(c.target);c.preventDefault(),e.hasClass("_select")||e.hasClass("_icon")?b.setIcon(d):e.hasClass("_remove")&&b.unsetIcon(d)},setIcon:function(c){var d=c.data("id"),e=b.frame,f=e.menuItems,g=f.get(d);return g?void b.pickIcon(g.toJSON()):(g={id:d,$el:c,$inputs:{}},c.find("div._settings input").each(function(){var b=a(this),c=b.attr("class").replace("_mi-","");g[c]=b.val(),g.$inputs[c]=b}),f.add(g),void b.pickIcon(g))},unsetIcon:function(a){var c=a.data("id");a.find("div._settings input").val(""),a.trigger("mi:update"),b.frame.menuItems.remove(c)},updateField:function(c){var d,e=a(c.currentTarget),f=e.find("a._select"),g=e.find("a._remove"),h=e.find("input._mi-type").val(),i=e.find("input._mi-icon").val(),j=e.find("input._mi-url").val();return""===h||""===i||0>_.indexOf(menuIcons.activeTypes,h)?(f.text(menuIcons.text.select).attr("title",""),void g.hide()):(d=b.templates[h]?b.templates[h]:b.templates[h]=wp.template("menu-icons-item-field-preview-"+iconPicker.types[h].templateId),g.show(),f.attr("title",menuIcons.text.change),void f.html(d({type:h,icon:i,url:j})))},init:function(){b.createFrame(),a(document).on("click",b.wrapClass,b.setUnset).on("mi:update",b.wrapClass,b.updateField),a(b.wrapClass).trigger("mi:update")}};b.init()}}(jQuery);